<html>
<head>
  <title>说明文档之文本读取与计数</title>
  <basefont face="Comic Sans MS" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/600986 (zh-CN, DDL); Windows/6.1.1 (Win64); EDAMVersion=V2;"/>
  <style>
    body, td {
      font-family: Comic Sans MS;
      font-size: 12pt;
    }
  </style>
</head>
<body>
<a name="496"/>
<h1>说明文档之文本读取与计数</h1>

<div>
<span><div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><ul><li><div><font style="font-size: 12pt;">技术路线</font></div></li></ul><div><div><font style="font-size: 12pt;"><br/></font></div><table style="border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 267px;"></col><col style="width: 269px;"></col></colgroup><tbody><tr><td style="width: 267px; padding: 8px; border: 1px solid;"><div><font style="font-size: 12pt;">提取中文和英文</font></div></td><td style="width: 269px; padding: 8px; border: 1px solid;"><div><font style="font-size: 12pt;">os操作</font></div></td></tr><tr><td style="width: 267px; padding: 8px; border: 1px solid;"><div><font style="font-size: 12pt;">对中文进行分词</font></div></td><td style="width: 269px; padding: 8px; border: 1px solid;"><div><font style="font-size: 12pt;">os操作</font></div><div><font style="font-size: 12pt;">jieba分词</font></div></td></tr><tr><td style="width: 267px; padding: 8px; border: 1px solid;"><div><font style="font-size: 12pt;">对中文文本和英文文本进行计数</font></div></td><td style="width: 269px; padding: 8px; border: 1px solid;"><div><font style="font-size: 12pt;">count</font></div></td></tr><tr><td style="width: 267px; padding: 8px; border: 1px solid;"><div><font style="font-size: 12pt;">导出为csv文件</font></div></td><td style="width: 269px; padding: 8px; border: 1px solid;"><div><font style="font-size: 12pt;">csv</font></div></td></tr></tbody></table><div><font style="font-size: 12pt;"><br/></font></div></div><ul><li><div><font style="font-size: 12pt;">函数</font></div></li></ul><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">lib.py中的各种功能函数</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><img src="说明文档之文本读取与计数_files/Image.png" type="image/png" data-filename="Image.png"/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><div><font style="font-size: 12pt;"><br/></font></div><table style="border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 197px;"></col><col style="width: 636px;"></col><col style="width: 677px;"></col></colgroup><tbody><tr><td style="width: 197px; padding: 8px; border: 1px solid;"><div><font style="font-size: 12pt;">name_lst</font></div></td><td style="width: 636px; padding: 8px; border: 1px solid;"><div><font style="font-size: 12pt;">传入文件夹名称，读取文件夹下所有文件的文件名，制作文件名列表</font></div></td><td style="width: 677px; padding: 8px; border: 1px solid;"><div><font style="font-size: 12pt;"><br/></font></div></td></tr><tr><td style="width: 197px; padding: 8px; border: 1px solid;"><div><font style="font-size: 12pt;">extract_content</font></div></td><td style="width: 636px; padding: 8px; border: 1px solid;"><div><font style="font-size: 12pt;">读取文件内容，针对ANSI格式文本（原文本就是ANSI格式）</font></div></td><td style="width: 677px; padding: 8px; border: 1px solid;"><div><font style="font-size: 12pt;"><br/></font></div></td></tr><tr><td style="width: 197px; padding: 8px; border: 1px solid;"><div><font style="font-size: 12pt;">extract_utf8_content</font></div></td><td style="width: 636px; padding: 8px; border: 1px solid;"><div><font style="font-size: 12pt;">读取文件内容，针对utf-8格式文本</font></div></td><td style="width: 677px; padding: 8px; border: 1px solid;"><div><font style="font-size: 12pt;"><br/></font></div></td></tr><tr><td style="width: 197px; padding: 8px; border: 1px solid;"><div><font style="font-size: 12pt;">write_into</font></div></td><td style="width: 636px; padding: 8px; border: 1px solid;"><div><font style="font-size: 12pt;">讲获取内容写入文件，写出时设置为utf-8编码</font></div></td><td style="width: 677px; padding: 8px; border: 1px solid;"><div><font style="font-size: 12pt;"><br/></font></div></td></tr><tr><td style="width: 197px; padding: 8px; border: 1px solid;"><div><font style="font-size: 12pt;">extract_en</font></div></td><td style="width: 636px; padding: 8px; border: 1px solid;"><div><font style="font-size: 12pt;">利用extract_content抓取文件内容之后，提取所有英文。</font></div><div><font style="font-size: 12pt;">并创建文件，将内容导入文件中</font></div></td><td style="width: 677px; padding: 8px; border: 1px solid;"><div><font style="font-size: 12pt;"><br/></font></div></td></tr><tr><td style="width: 197px; padding: 8px; border: 1px solid;"><div><font style="font-size: 12pt;">extract_zh</font></div></td><td style="width: 636px; padding: 8px; border: 1px solid;"><div><font style="font-size: 12pt;">内容同上</font></div></td><td style="width: 677px; padding: 8px; border: 1px solid;"><div><font style="font-size: 12pt;"><br/></font></div></td></tr><tr><td style="width: 197px; padding: 8px; border: 1px solid;"><div><font style="font-size: 12pt;">count_en</font></div></td><td style="width: 636px; padding: 8px; border: 1px solid;"><div><font style="font-size: 12pt;">进行词频统计</font></div><div><font style="font-size: 12pt;"><span style="font-weight: bold;">思路：</span><span style="text-align: justify; font-weight: bold; color: rgb(1, 1, 1); line-height: 150%;">统计词频——生成文件——</span><span style="text-align: justify; font-weight: bold; color: rgb(1, 1, 1); line-height: 150%;">return</span><span style="text-align: justify; font-weight: bold; color: rgb(1, 1, 1); line-height: 150%;">（词，词频）</span><span style="text-align: justify; font-weight: bold; color: rgb(1, 1, 1); line-height: 150%;">list</span></font></div></td><td style="width: 677px; padding: 8px; border: 1px solid;"><div><font style="font-size: 12pt;"><br/></font></div></td></tr><tr><td style="width: 197px; padding: 8px; border: 1px solid;"><div><font style="font-size: 12pt;">count_zh</font></div></td><td style="width: 636px; padding: 8px; border: 1px solid;"><div><font style="font-size: 12pt;">使用结巴分词并进行词频统计</font></div><div style="text-align: justify;"><font style="font-size: 12pt;"><span style="line-height: 150%; font-weight: bold; color: rgb(1, 1, 1);">思路：分词——生成分词文件——统计词频——生成文件——</span><span style="line-height: 150%; font-weight: bold; color: rgb(1, 1, 1);">return</span><span style="line-height: 150%; font-weight: bold; color: rgb(1, 1, 1);">（词，词频）</span><span style="line-height: 150%; font-weight: bold; color: rgb(1, 1, 1);">list</span></font></div></td><td style="width: 677px; padding: 8px; border: 1px solid;"><div><font style="font-size: 12pt;">针对处理好的中文文本进行分词测试经过精确模式、全模式、搜索模式测试后，选择采用全模式：</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><img src="说明文档之文本读取与计数_files/Image [1].png" type="image/png" data-filename="Image.png"/></font></div><div><font style="font-size: 12pt;"><img src="说明文档之文本读取与计数_files/Image [2].png" type="image/png" data-filename="Image.png"/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="line-height: 150%;-en-paragraph:true;"><font style="font-size: 12pt;">为使得代码更加简洁，沿用读取、生成文件夹下文件的函数。但多次尝试，仅生成了空文件夹。</font></span></div><div><font style="font-size: 12pt;"><img src="说明文档之文本读取与计数_files/Image [3].png" type="image/png" data-filename="Image.png"/></font></div><div><font style="font-size: 12pt;"><span style="line-height: 150%;-en-paragraph:true;">经过调试后发现，无法读取文件内容。查询了</span><span style="line-height: 150%;-en-paragraph:true;">open()</span><span style="line-height: 150%;-en-paragraph:true;">函数详细解析发现，即使文件采用</span><span style="line-height: 150%;-en-paragraph:true;">utf-8</span><span style="line-height: 150%;-en-paragraph:true;">编码，在读写文件时常常仍需指定编码方式</span><span style="line-height: 150%;-en-paragraph:true;">encoding='utf-8'</span><span style="line-height: 150%;-en-paragraph:true;">。</span></font></div><div><font style="font-size: 12pt;"><img src="说明文档之文本读取与计数_files/Image [4].png" type="image/png" data-filename="Image.png"/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="line-height: 150%;-en-paragraph:true;">测试文件统计词频，得到元组数据</span><span style="line-height: 150%;-en-paragraph:true;">(‘</span><span style="line-height: 150%;-en-paragraph:true;">词</span><span style="line-height: 150%;-en-paragraph:true;">’,</span><span style="line-height: 150%;-en-paragraph:true;">词频</span><span style="line-height: 150%;-en-paragraph:true;">)</span><span style="line-height: 150%;-en-paragraph:true;">组成的</span><span style="line-height: 150%;-en-paragraph:true;">list</span><span style="line-height: 150%;-en-paragraph:true;">类型</span><span style="line-height: 150%;-en-paragraph:true;">li</span><span style="line-height: 150%;-en-paragraph:true;">。通过将</span><span style="line-height: 150%;-en-paragraph:true;">list</span><span style="line-height: 150%;-en-paragraph:true;">类型转换成</span><span style="line-height: 150%;-en-paragraph:true;">str</span><span style="line-height: 150%;-en-paragraph:true;">，将</span><span style="line-height: 150%;-en-paragraph:true;">li</span><span style="line-height: 150%;-en-paragraph:true;">写入文件。</span></font></div><div><span style="line-height: 150%;-en-paragraph:true;"><font style="font-size: 12pt;"><br/></font></span></div><div><font style="font-size: 12pt;"><img src="说明文档之文本读取与计数_files/Image [5].png" type="image/png" data-filename="Image.png"/></font></div></td></tr><tr><td style="width: 197px; padding: 8px; border: 1px solid;"><div><font style="font-size: 12pt;">Read</font></div></td><td style="width: 636px; padding: 8px; border: 1px solid;"><div><font style="font-size: 12pt;">将上述函数连接起来</font></div><div><font style="font-size: 12pt;">主要涉及到一些os操作，需要注意函数运行当时所处的文件</font></div></td><td style="width: 677px; padding: 8px; border: 1px solid;"><div><font style="font-size: 12pt;"><br/></font></div></td></tr><tr><td style="width: 197px; padding: 8px; border: 1px solid;"><div><font style="font-size: 12pt;">to_csv</font></div></td><td style="width: 636px; padding: 8px; border: 1px solid;"><div><font style="font-size: 12pt;">保存成为csv文件，输出为csv编码</font></div></td><td style="width: 677px; padding: 8px; border: 1px solid;"><div><font style="font-size: 12pt;">函数需要输入一个list，导出csv文件。所以先自行简单写了几行代码来实现将list导出保存成csv文件的功能：</font></div><div><font style="font-size: 12pt;">进行测试：</font></div><div><font style="font-size: 12pt;"><img src="说明文档之文本读取与计数_files/Image [6].png" type="image/png" data-filename="Image.png"/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><img src="说明文档之文本读取与计数_files/Image [7].png" type="image/png" data-filename="Image.png"/></font></div></td></tr></tbody></table><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">main.py主函数</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><img src="说明文档之文本读取与计数_files/Image [8].png" type="image/png" data-filename="Image.png"/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><div><font style="font-size: 12pt;"><br/></font></div><table style="border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 179px;"></col><col style="width: 850px;"></col><col style="width: 295px;"></col></colgroup><tbody><tr><td style="width: 179px; padding: 8px; border: 1px solid;"><div><font style="font-size: 12pt;">Read</font></div></td><td style="width: 850px; padding: 8px; border: 1px solid;"><div><font style="font-size: 12pt;"><img src="说明文档之文本读取与计数_files/Image [9].png" type="image/png" data-filename="Image.png"/></font></div></td><td style="width: 295px; padding: 8px; border: 1px solid;"><div><font style="font-size: 12pt;">注意异常处理</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">注意os操作以及读取文件的函数的选取（源文件编码并非utf-8）</font></div></td></tr><tr><td style="width: 179px; padding: 8px; border: 1px solid;"><div><font style="font-size: 12pt;">CountZh</font></div></td><td style="width: 850px; padding: 8px; border: 1px solid;"><div><font style="font-size: 12pt;"><img src="说明文档之文本读取与计数_files/Image [10].png" type="image/png" data-filename="Image.png"/></font></div></td><td style="width: 295px; padding: 8px; border: 1px solid;"><div><font style="font-size: 12pt;">中文词频统计</font></div></td></tr><tr><td style="width: 179px; padding: 8px; border: 1px solid;"><div><font style="font-size: 12pt;">CountEn</font></div></td><td style="width: 850px; padding: 8px; border: 1px solid;"><div><span style="font-weight: bold;"><font style="font-size: 12pt;"><img src="说明文档之文本读取与计数_files/Image [11].png" type="image/png" data-filename="Image.png"/></font></span></div></td><td style="width: 295px; padding: 8px; border: 1px solid;"><div><font style="font-size: 12pt;">英文词频统计</font></div></td></tr><tr><td style="width: 179px; padding: 8px; border: 1px solid;"><div><font style="font-size: 12pt;">main</font></div></td><td style="width: 850px; padding: 8px; border: 1px solid;"><div><font style="font-size: 12pt;"><img src="说明文档之文本读取与计数_files/Image [12].png" type="image/png" data-filename="Image.png"/></font></div></td><td style="width: 295px; padding: 8px; border: 1px solid;"><div><font style="font-size: 12pt;">采用魔法方法</font></div></td></tr></tbody></table><div><font style="font-size: 12pt;"><br/></font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><ul><li><div><font style="font-size: 12pt;">难点</font></div></li></ul><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">Q1：为什么要有两种读取文本的方法？</font></div><div><font style="font-size: 12pt;">对于编码的处理：文件格式不一样，要采用不同的文件读取方法</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">Q2：为什么计数之后还要再生成文件，同时还要返回一个list？</font></div><div><font style="font-size: 12pt;">生成文件是为了能够保存结果</font></div><div><font style="font-size: 12pt;">而返回list的原因如下：</font></div><div><font style="font-size: 12pt;"><span style="text-align: justify; text-indent: 8mm; line-height: 150%; color: rgb(1, 1, 1);">拿到另外两位同学的代码以后，我把自己的代码加了进去，却发现读取到的数据并不能进行</span><span style="text-align: justify; text-indent: 8mm; line-height: 150%; color: rgb(1, 1, 1);">to_csv</span><span style="text-align: justify; text-indent: 8mm; line-height: 150%; color: rgb(1, 1, 1);">操作，后面发现是因为在我提取文件内容时，</span><span style="text-align: justify; text-indent: 8mm; line-height: 150%; color: rgb(1, 1, 1);">f.read()</span><span style="text-align: justify; text-indent: 8mm; line-height: 150%; color: rgb(1, 1, 1);">返回的结果是字符串并不是</span><span style="text-align: justify; text-indent: 8mm; line-height: 150%; color: rgb(1, 1, 1);">list</span><span style="text-align: justify; text-indent: 8mm; line-height: 150%; color: rgb(1, 1, 1);">。</span></font></div><div style="line-height: 150%; text-align: justify;"><font style="font-size: 12pt;"><img src="说明文档之文本读取与计数_files/Image [13].png" type="image/png" data-filename="Image.png" width="554"/></font></div><div style="line-height: 150%; text-align: justify;"><span style="color: rgb(1, 1, 1); text-indent: 8mm;"><font style="font-size: 12pt;">虽然查询过后也有别的读取文件函数可以返回list，但看代码发现前面的同学分词的结果是以list存储的，只不过写入文件后得到的是字符串类型，所以只要将分词和计算词频的函数的返回值改成list，再直接将这两个函数的返回值作为to_csv函数的输入值即可。</font></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><img src="说明文档之文本读取与计数_files/Image [14].png" type="image/png" data-filename="Image.png"/></font></div><div><font style="font-size: 12pt;"><br/></font></div></div><div><br/></div></span>
</div></body></html> 